<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Google Vector Layers - ArcGIS Server Demo</title>
        <meta name="description" content="Display vector data from ArcGIS Server, GeoIQ, Geocommons, Arc2Earth, CartoDB and others in Google Maps">
        <meta name="author" content="Jason Sanford">

        <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
        <!--[if lt IE 9]>
            <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->

        <!-- Le styles -->
        <link href="../../docs-demo/css/bootstrap.css" rel="stylesheet">
        <link href="../../docs-demo/css/prettify.css" rel="stylesheet">
        <link href="../../docs-demo/css/demo.css" rel="stylesheet">
        <style type="text/css">
            body {
                padding-top: 60px;
            }
            .container-fluid > .sidebar {
                position: fixed !important;
                margin-top: 60px;
            }
        </style>

    </head>

    <body>
        <a href="https://github.com/JasonSanford/google-vector-layers"><img style="position: fixed; top: 0; right: 0; border: 0; z-index: 10001;" src="https://a248.e.akamai.net/assets.github.com/img/e6bef7a091f5f3138b8cd40bc3e114258dd68ddf/687474703a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f7265645f6161303030302e706e67" alt="Fork me on GitHub"></a>
        <div class="topbar" data-dropdown="dropdown">
            <div class="topbar-inner">
                <div class="container-fluid">
                    <a class="brand" href="../../">Google Vector Layers</a>
                    <ul class="nav">
                        <li><a href="../../">Home</a></li>
                        <li><a href="../../documentation">Documentation</a></li>
                        <li class="dropdown active">
                            <a href="demos" class="dropdown-toggle">Demos</a>
                            <ul class="dropdown-menu">
                                <li class="active"><a href="../arcgis-server">ArcGIS Server</a></li>
                                <li><a href="../arc2earth">Arc2Earth</a></li>
                                <li><a href="../cartodb">CartoDB</a></li>
                                <li><a href="../geoiq">GeoIQ</a></li>
                            </ul>
                        </li>
                        <li><a href="../../tips-tricks">Tips + Tricks</a></li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="content">
                <h1>ArcGIS Server</h1>
                <h2>Light Rail Lines</h2>
                <p>This example has a simple, single symbology and uses the "showAll" parameter to fetch all features at once since there are only a handful.</p>
                <div class="row demo">
                    <div class="span6 height-controlled">
                        <pre class="prettyprint">ags_light_rail = new gvector.AGS({
    url: "http://maps.rtd-denver.com/ArcGIS/rest/services/SystemMapLiteGoogleVectors/MapServer/1",
    fields: "*",
    scaleRange: [13, 20],
    showAll: true,
    symbology: {
        type: "single",
        vectorOptions: {
            strokeWeight: 4,
            strokeOpacity: 0.8,
            strokeColor: "#004a00"
        }    
    },
    infoWindowTemplate: '&lt;div class="iw-content"&gt;&lt;h3&gt;Light Rail Line&lt;/h3&gt;&lt;table&gt;&lt;tr&gt;&lt;th&gt;Route&lt;/th&gt;&lt;td&gt;{ROUTE}&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;'
});</pre>
                    </div>
                    <div class="span10 height-controlled">
                        <div id="map-container-1" class="map">
                            <div class="layer-buttons">
                                <div class="row layer-button-row"><a href="javascript:ags_light_rail.setMap(map1);" class="btn success">Layer On</a> <a href="javascript:ags_light_rail.setMap(null);" class="btn danger">Layer Off</a></div>
                            </div>
                        </div>
                    </div>
                </div>
                <hr>
                <h2>RTD Director Districts</h2>
                <p>This example has features styled using the "unique" symbology type where values of a particular attribute ("DISTRICT" in this example) have a specific style. We also supply a "where" parameter to keep the feature count to a minimum for this demo.</p>
                <div class="row demo">
                    <div class="span6 height-controlled">
                        <pre class="prettyprint">ags_director_districts = new gvector.AGS({
    url: "http://maps.rtd-denver.com/ArcGIS/rest/services/DirectorDistricts/MapServer/1",
    fields: "OBJECTID,DISTRICT,URL,MAP",
    showAll: true,
    scaleRange: [4, 14],
    where: "DISTRICT+NOT+IN('I','J','K','L','M','N','O')",
    symbology: {
        type: "unique",
        property: "DISTRICT",
        values: [
            {
                value: "A",
                vectorOptions: {
                    fillColor: "#6600FF",
                    fillOpacity: 0.6,
                    strokeColor: "#666666",
                    strokeOpacity: 0.8,
                    strokeWeight: 1
                }
            }, {
                value: "B",
                vectorOptions: {
                    fillColor: "#660066",
                    fillOpacity: 0.6,
                    strokeColor: "#666666",
                    strokeOpacity: 0.8,
                    strokeWeight: 1
                }
            }, {
                value: "C",
                vectorOptions: {
                    fillColor: "#FF9900",
                    fillOpacity: 0.6,
                    strokeColor: "#666666",
                    strokeOpacity: 0.8,
                    strokeWeight: 1
                }
            }, {
                value: "D",
                vectorOptions: {
                    fillColor: "#00FFFF",
                    fillOpacity: 0.6,
                    strokeColor: "#666666",
                    strokeOpacity: 0.8,
                    strokeWeight: 1
                }
            }, {
                value: "E",
                vectorOptions: {
                    fillColor: "#FFFF00",
                    fillOpacity: 0.6,
                    strokeColor: "#666666",
                    strokeOpacity: 0.8,
                    strokeWeight: 1
                }
            }, {
                value: "F",
                vectorOptions: {
                    fillColor: "#003333",
                    fillOpacity: 0.6,
                    strokeColor: "#666666",
                    strokeOpacity: 0.8,
                    strokeWeight: 1
                }
            }, {
                value: "G",
                vectorOptions: {
                    fillColor: "#ff7800",
                    fillOpacity: 0.6,
                    strokeColor: "#666666",
                    strokeOpacity: 0.8,
                    strokeWeight: 1
                }
            }, {
                value: "H",
                vectorOptions: {
                    fillColor: "#46461f",
                    fillOpacity: 0.6,
                    strokeColor: "#666666",
                    strokeOpacity: 0.8,
                    strokeWeight: 1
                }
            }
        ]
    },
    infoWindowTemplate: '&lt;div class="iw-content"&gt;&lt;h3&gt;District {DISTRICT}&lt;/h3&gt;&lt;table&gt;&lt;tr&gt;&lt;th&gt;Links&lt;/th&gt;&lt;td&gt;&lt;a target="_blank" href="{MAP}"&gt;Map&lt;/a&gt;, &lt;a href="{URL}" target="_blank"&gt;Director\'s Website&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;',
    singleInfoWindow: true
});</pre>
                    </div>
                    <div class="span10 height-controlled">
                        <div id="map-container-2" class="map">
                            <div class="layer-buttons">
                                <div class="row layer-button-row"><a href="javascript:ags_districts.setMap(map2);" class="btn success">Layer On</a> <a href="javascript:ags_districts.setMap(null);" class="btn danger">Layer Off</a></div>
                            </div>
                        </div>
                    </div>
                </div>
                <hr>
                <h2>Live Bus Locations</h2>
                <p>Here we're using the "dynamic" and "autoUpdate" options to refresh map data every 5 seconds. If a bus changes location or speed, the map marker moves and (potentially) changes color. We're using the range symbology type here where stopped buses (0 mph) are black, slow buses (1 - 20 mph) are orange and fast buses (21 - 100 mph) are green.</p>
                <p>Unfortunately each bus updates their current location every few minutes, but if you wait around for a few seconds you should see a bus or two move and/or change speed.</p>
                <div class="row demo">
                    <div class="span6 height-controlled">
                        <pre class="prettyprint">ags_buses = new gvector.AGS({
    url: "http://maps.rtd-denver.com/ArcGIS/rest/services/BusLocations/MapServer/0",
    fields: "OBJECTID,SPEED,VEHICLE_ALIAS,SPEED,ROUTE,OPERATOR_LNAME,OPERATOR_FNAME,LOCKTIME",
    uniqueField: "OBJECTID",
    scaleRange: [13, 20],
    symbology: {
        type: "range",
        property: "SPEED",
        ranges: [
            {
                range: [0, 0],
                vectorOptions: {
                    icon: "../../docs-demo/img/markers/bus-black.png"
                }
            },{
                range: [1, 20],
                vectorOptions: {
                    icon: "../../docs-demo/img/markers/bus-brown.png"
                }
            },{
                range: [21, 100],
                vectorOptions: {
                    icon: "../../docs-demo/img/markers/bus-green.png"
                }
            }
        ]
    },
    dynamic: true,
    autoUpdate: true,
    autoUpdateInterval: 5000,
    infoWindowTemplate: '&lt;div class="iw-content"&gt;&lt;h3&gt;Bus #{VEHICLE_ALIAS}&lt;/h3&gt;&lt;table&gt;&lt;tr&gt;&lt;th&gt;Speed&lt;/th&gt;&lt;td&gt;{SPEED} mph&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;Route&lt;/th&gt;&lt;td&gt;{ROUTE}&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;Operator&lt;/th&gt;&lt;td&gt;{OPERATOR_LNAME},{OPERATOR_FNAME}&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;Last GPS Lock&lt;/th&gt;&lt;td&gt;{LOCKTIME}&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;'
});</pre>
                    </div>
                    <div class="span10 height-controlled">
                        <div id="map-container-3" class="map">
                            <div class="layer-buttons">
                                <div class="layer-button-row row"><a href="javascript:ags_buses.setMap(map3);" class="btn success">Layer On</a> <a href="javascript:ags_buses.setMap(null);" class="btn danger">Layer Off</a></div>
                            </div>
                        </div>
                    </div>
                </div>
                <hr>
                <h2 id="charts-graphs">les personnes âgées</h2>
                <p>This example has features styled using the "range" symbology type where values of a particular attribute ("MED_AGE" in this example) within a specific range have a specific style. Polygons with lighter shades have a population with a lower median age while the darker polygons have an older population.</p>
                <p>Also, instead of a string-based "infoWindowTempate", we're using a function that is passed feature attributes and returns a string for populating the infoWindow. This way we can do more complex things with our attributes, like create charts.</p>
                <div class="row demo">
                    <div class="span6 height-controlled">
                        <pre class="prettyprint">ags_census = new gvector.AGS({
    url: "http://sampleserver1.arcgisonline.com/ArcGIS/rest/services/Demographics/ESRI_Census_USA/MapServer/3",
    fields: "ObjectID,NAME,STATE_NAME,POP2000,MED_AGE,AGE_UNDER5,AGE_5_17,AGE_18_21,AGE_22_29,AGE_30_39,AGE_40_49,AGE_50_64,AGE_65_UP",
    uniqueField: "ObjectID",
    scaleRange: [6, 20],
    symbology: {
        type: "range",
        property: "MED_AGE",
        ranges: [
            {
                range: [0, 32],
                vectorOptions: {
                    strokeWeight: 1,
                    strokeColor: "#666666",
                    strokeOpacity: 0.5,
                    fillOpacity: 0.8,
                    fillColor: "#FFFFCC"
                }
            },{
                range: [32.0000001, 40],
                vectorOptions: {
                    strokeWeight: 1,
                    strokeColor: "#666666",
                    strokeOpacity: 0.5,
                    fillOpacity: 0.8,
                    fillColor: "#C2E699"
                }
            },{
                range: [44.0000001, 50],
                vectorOptions: {
                    strokeWeight: 1,
                    strokeColor: "#666666",
                    strokeOpacity: 0.5,
                    fillOpacity: 0.8,
                    fillColor: "#78C679"
                }
            },{
                range: [50.0000001, 100],
                vectorOptions: {
                    strokeWeight: 1,
                    strokeColor: "#666666",
                    strokeOpacity: 0.5,
                    fillOpacity: 0.8,
                    fillColor: "#238443"
                }
            },{
                range: [35.0000001, 48],
                vectorOptions: {
                    strokeWeight: 1,
                    strokeColor: "#666666",
                    strokeOpacity: 0.5,
                    fillOpacity: 0.8,
                    fillColor: "#C2E699"
                }
            }
        ]    
    },
    infoWindowTemplate: function(atts) {
        var totPop = atts.POP2000;
        
        var percent_under_5 = (atts.AGE_UNDER5/totPop) * 100,
            percent_5_17 = (atts.AGE_5_17/totPop) * 100,
            percent_18_21 = (atts.AGE_18_21/totPop) * 100,
            percent_22_29 = (atts.AGE_22_29/totPop) * 100,
            percent_30_39 = (atts.AGE_30_39/totPop) * 100,
            percent_40_49 = (atts.AGE_40_49/totPop) * 100,
            percent_50_64 = (atts.AGE_50_64/totPop) * 100,
            percent_65_up = (atts.AGE_65_UP/totPop) * 100;
        
        var imageURL = "http://chart.googleapis.com/chart?cht=p&chs=285x150&chl=%3C5|5%20-%2017|18%20-%2021|22%20-%2029|30%20-%2039|40%20-%2049|50%20-%2064|%3E64&chdl=" + parseInt(percent_under_5) + "%|" + parseInt(percent_5_17) + "%|" + parseInt(percent_18_21) + "%|" + parseInt(percent_22_29) + "%|" + parseInt(percent_30_39) + "%|" + parseInt(percent_40_49) + "%|" + parseInt(percent_50_64) + "%|" + parseInt(percent_65_up) + "&chd=t:" + percent_under_5 + "," + percent_5_17 + "," + percent_18_21 + "," + percent_22_29 + "," + percent_30_39 + "," + percent_40_49 + "," + percent_50_64 + "," + percent_65_up;
        return '&lt;div class="iw-content"&gt;&lt;h3&gt;' + atts.NAME + ' County, ' + atts.STATE_NAME + '&lt;/h3&gt;&lt;h4&gt;Median Age: ' + atts.MED_AGE + '&lt;/h4&gt;&lt;img style="height:150px;width:285px;" src="' + imageURL + '" /&gt;&lt;/div&gt;';
    },
    singleInfoWindow: true
});</pre>
                    </div>
                    <div class="span10 height-controlled">
                        <div id="map-container-4" class="map">
                            <div class="layer-buttons">
                                <div class="row layer-button-row"><a href="javascript:ags_census.setMap(map4);" class="btn success">Layer On</a> <a href="javascript:ags_census.setMap(null);" class="btn danger">Layer Off</a></div>
                            </div>
                        </div>
                    </div>
                </div>
                <footer> 	
                    <p>&copy; Jason Sanford - geojason.info 2011</p>
                </footer>
            </div>
        </div>
        <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=true"></script>
        <script src="../../docs-demo/js/prettify.js" type="text/javascript"></script>
        <script src="../../docs-demo/js/jquery-1.5.2.min.js" type="text/javascript"></script>
        <script src="../../docs-demo/js/docs-demos.js" type="text/javascript"></script>
        <script src="../../docs-demo/js/bootstrap-dropdown.js" type="text/javascript"></script>
        <!-- TODO: Replace with built/minified gvector.js -->
        <script src="../../debug/gvector-include.js" type="text/javascript"></script>
        <script type="text/javascript">
            var map1, map2, map3, map4;
            var ags_light_rail, ags_districts, ags_buses, ags_census;
            $(document).ready(function() {
            
                map1 = new google.maps.Map(document.getElementById("map-container-1"), {
                    center: new google.maps.LatLng(39.74154151936245, -104.99968229904174),
                    zoom: 14,
                    mapTypeId: google.maps.MapTypeId.ROADMAP,
                    noClear: true
                });
                
                map2 = new google.maps.Map(document.getElementById("map-container-2"), {
                    center: new google.maps.LatLng(39.616824056902196, -104.80742155685424),
                    zoom: 10,
                    mapTypeId: google.maps.MapTypeId.ROADMAP,
                    noClear: true
                });
                
                map3 = new google.maps.Map(document.getElementById("map-container-3"), {
                    center: new google.maps.LatLng(39.75111061205554, -104.99916731491088),
                    zoom: 15,
                    mapTypeId: google.maps.MapTypeId.SATELLITE,
                    noClear: true
                });
                
                map4 = new google.maps.Map(document.getElementById("map-container-4"), {
                    center: new google.maps.LatLng(29.005243760843864, -82.10365950241086),
                    zoom: 6,
                    minZoom: 6,
                    mapTypeId: google.maps.MapTypeId.ROADMAP,
                    noClear: true
                });
                
                ags_light_rail = new gvector.AGS({
                    url: "http://maps.rtd-denver.com/ArcGIS/rest/services/SystemMapLiteGoogleVectors/MapServer/1",
                    fields: "*",
                    scaleRange: [13, 20],
                    showAll: true,
                    symbology: {
                        type: "single",
                        vectorOptions: {
                            strokeWeight: 4,
                            strokeOpacity: 0.8,
                            strokeColor: "#004a00"
                        }    
                    },
                    infoWindowTemplate: '<div class="iw-content"><h3>Light Rail Line</h3><table class="condensed-table"><tr><th>Route</th><td>{ROUTE}</td></tr></table></div>'
                });
                
                ags_districts = new gvector.AGS({
                    url: "http://maps.rtd-denver.com/ArcGIS/rest/services/DirectorDistricts/MapServer/1",
                    fields: "OBJECTID,DISTRICT,URL,MAP",
                    showAll: true,
                    scaleRange: [4, 14],
                    where: "DISTRICT+NOT+IN('I','J','K','L','M','N','O')",
                    symbology: {
                        type: "unique",
                        property: "DISTRICT",
                        values: [
                            {
                                value: "A",
                                vectorOptions: {
                                    fillColor: "#6600FF",
                                    fillOpacity: 0.6,
                                    strokeColor: "#666666",
                                    strokeOpacity: 0.8,
                                    strokeWeight: 1
                                }
                            }, {
                                value: "B",
                                vectorOptions: {
                                    fillColor: "#660066",
                                    fillOpacity: 0.6,
                                    strokeColor: "#666666",
                                    strokeOpacity: 0.8,
                                    strokeWeight: 1
                                }
                            }, {
                                value: "C",
                                vectorOptions: {
                                    fillColor: "#FF9900",
                                    fillOpacity: 0.6,
                                    strokeColor: "#666666",
                                    strokeOpacity: 0.8,
                                    strokeWeight: 1
                                }
                            }, {
                                value: "D",
                                vectorOptions: {
                                    fillColor: "#00FFFF",
                                    fillOpacity: 0.6,
                                    strokeColor: "#666666",
                                    strokeOpacity: 0.8,
                                    strokeWeight: 1
                                }
                            }, {
                                value: "E",
                                vectorOptions: {
                                    fillColor: "#FFFF00",
                                    fillOpacity: 0.6,
                                    strokeColor: "#666666",
                                    strokeOpacity: 0.8,
                                    strokeWeight: 1
                                }
                            }, {
                                value: "F",
                                vectorOptions: {
                                    fillColor: "#003333",
                                    fillOpacity: 0.6,
                                    strokeColor: "#666666",
                                    strokeOpacity: 0.8,
                                    strokeWeight: 1
                                }
                            }, {
                                value: "G",
                                vectorOptions: {
                                    fillColor: "#ff7800",
                                    fillOpacity: 0.6,
                                    strokeColor: "#666666",
                                    strokeOpacity: 0.8,
                                    strokeWeight: 1
                                }
                            }, {
                                value: "H",
                                vectorOptions: {
                                    fillColor: "#46461f",
                                    fillOpacity: 0.6,
                                    strokeColor: "#666666",
                                    strokeOpacity: 0.8,
                                    strokeWeight: 1
                                }
                            }
                        ]
                    },
                    infoWindowTemplate: '<div class="iw-content"><h3>District {DISTRICT}</h3><table><tr><th>Links</th><td><a target="_blank" href="{MAP}">Map</a>, <a href="{URL}" target="_blank">Director\'s Website</a></td></tr></table></div>',
                    singleInfoWindow: true
                });
                
                ags_buses = new gvector.AGS({
                    url: "http://maps.rtd-denver.com/ArcGIS/rest/services/BusLocations/MapServer/0",
                    fields: "OBJECTID,SPEED,VEHICLE_ALIAS,SPEED,ROUTE,OPERATOR_LNAME,OPERATOR_FNAME,LOCKTIME",
                    uniqueField: "OBJECTID",
                    scaleRange: [13, 20],
                    symbology: {
                        type: "range",
                        property: "SPEED",
                        ranges: [
                            {
                                range: [0, 0],
                                vectorOptions: {
                                    icon: "../../docs-demo/img/markers/bus-black.png"
                                }
                            },{
                                range: [1, 20],
                                vectorOptions: {
                                    icon: "../../docs-demo/img/markers/bus-brown.png"
                                }
                            },{
                                range: [21, 100],
                                vectorOptions: {
                                    icon: "../../docs-demo/img/markers/bus-green.png"
                                }
                            }
                        ]
                    },
                    dynamic: true,
                    autoUpdate: true,
                    autoUpdateInterval: 5000,
                    infoWindowTemplate: '<div class="iw-content"><h3>Bus #{VEHICLE_ALIAS}</h3><table class="condensed-table"><tr><th>Speed</th><td>{SPEED} mph</td></tr><tr><th>Route</th><td>{ROUTE}</td></tr><tr><th>Operator</th><td>{OPERATOR_LNAME},{OPERATOR_FNAME}</td></tr><tr><th>Last GPS Lock</th><td>{LOCKTIME}</td></tr></table></div>',
                    singleInfoWindow: true
                });
                
                ags_census = new gvector.AGS({
                    url: "http://sampleserver1.arcgisonline.com/ArcGIS/rest/services/Demographics/ESRI_Census_USA/MapServer/3",
                    fields: "ObjectID,NAME,STATE_NAME,POP2000,MED_AGE,AGE_UNDER5,AGE_5_17,AGE_18_21,AGE_22_29,AGE_30_39,AGE_40_49,AGE_50_64,AGE_65_UP",
                    uniqueField: "ObjectID",
                    scaleRange: [6, 20],
                    symbology: {
                        type: "range",
                        property: "MED_AGE",
                        ranges: [
                            {
                                range: [0, 32],
                                vectorOptions: {
                                    strokeWeight: 1,
                                    strokeColor: "#666666",
                                    strokeOpacity: 0.5,
                                    fillOpacity: 0.8,
                                    fillColor: "#FFFFCC"
                                }
                            },{
                                range: [32.0000001, 40],
                                vectorOptions: {
                                    strokeWeight: 1,
                                    strokeColor: "#666666",
                                    strokeOpacity: 0.5,
                                    fillOpacity: 0.8,
                                    fillColor: "#C2E699"
                                }
                            },{
                                range: [44.0000001, 50],
                                vectorOptions: {
                                    strokeWeight: 1,
                                    strokeColor: "#666666",
                                    strokeOpacity: 0.5,
                                    fillOpacity: 0.8,
                                    fillColor: "#78C679"
                                }
                            },{
                                range: [50.0000001, 100],
                                vectorOptions: {
                                    strokeWeight: 1,
                                    strokeColor: "#666666",
                                    strokeOpacity: 0.5,
                                    fillOpacity: 0.8,
                                    fillColor: "#238443"
                                }
                            },{
                                range: [35.0000001, 48],
                                vectorOptions: {
                                    strokeWeight: 1,
                                    strokeColor: "#666666",
                                    strokeOpacity: 0.5,
                                    fillOpacity: 0.8,
                                    fillColor: "#C2E699"
                                }
                            }
                        ]    
                    },
                    infoWindowTemplate: function(atts) {
                        var totPop = atts.POP2000;
                        
                        var percent_under_5 = (atts.AGE_UNDER5/totPop) * 100,
                            percent_5_17 = (atts.AGE_5_17/totPop) * 100,
                            percent_18_21 = (atts.AGE_18_21/totPop) * 100,
                            percent_22_29 = (atts.AGE_22_29/totPop) * 100,
                            percent_30_39 = (atts.AGE_30_39/totPop) * 100,
                            percent_40_49 = (atts.AGE_40_49/totPop) * 100,
                            percent_50_64 = (atts.AGE_50_64/totPop) * 100,
                            percent_65_up = (atts.AGE_65_UP/totPop) * 100;
                        
                        var imageURL = "http://chart.googleapis.com/chart?cht=p&chs=285x150&chl=%3C5|5%20-%2017|18%20-%2021|22%20-%2029|30%20-%2039|40%20-%2049|50%20-%2064|%3E64&chdl=" + parseInt(percent_under_5) + "%|" + parseInt(percent_5_17) + "%|" + parseInt(percent_18_21) + "%|" + parseInt(percent_22_29) + "%|" + parseInt(percent_30_39) + "%|" + parseInt(percent_40_49) + "%|" + parseInt(percent_50_64) + "%|" + parseInt(percent_65_up) + "&chd=t:" + percent_under_5 + "," + percent_5_17 + "," + percent_18_21 + "," + percent_22_29 + "," + percent_30_39 + "," + percent_40_49 + "," + percent_50_64 + "," + percent_65_up;
                        return '<div class="iw-content"><h3>' + atts.NAME + ' County, ' + atts.STATE_NAME + '</h3><h4>Median Age: ' + atts.MED_AGE + '</h4><img style="height:150px;width:285px;" src="' + imageURL + '" /></div>';
                    },
                    singleInfoWindow: true
                });
                
            });
        </script>
    </body>
</html>